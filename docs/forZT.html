<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è€å©†ç”Ÿæ—¥å¿«ä¹ï¼</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&family=Noto+Serif+SC:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Noto Serif SC', serif;
            overflow-x: hidden;
            background-color: #0f172a;
        }
        .handwriting {
            font-family: 'Ma Shan Zheng', cursive;
        }
        
        /* Star Animation */
        .star {
            position: absolute;
            background: white;
            border-radius: 50%;
            animation: twinkle var(--duration) ease-in-out infinite;
            opacity: var(--opacity);
        }
        @keyframes twinkle {
            0%, 100% { opacity: 0.2; transform: scale(0.8); }
            50% { opacity: 1; transform: scale(1.2); }
        }

        /* Heart Beat */
        @keyframes heartbeat {
            0% { transform: scale(1); }
            15% { transform: scale(1.3); }
            30% { transform: scale(1); }
            45% { transform: scale(1.15); }
            60% { transform: scale(1); }
        }
        .animate-heartbeat {
            animation: heartbeat 1.5s infinite;
        }

        /* Floating Animation */
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }
        .animate-float {
            animation: float 6s ease-in-out infinite;
        }

        /* Music Disc Spin */
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        .animate-spin-slow {
            animation: spin 8s linear infinite;
        }

        /* Candle Flame */
        .flame {
            animation: flicker 1s infinite alternate;
            transform-origin: center bottom;
        }
        @keyframes flicker {
            0% { transform: scale(1); opacity: 0.9; }
            100% { transform: scale(1.1) rotate(2deg); opacity: 1; }
        }
        .smoke {
            animation: rise 2s forwards;
        }
        @keyframes rise {
            0% { transform: translateY(0) scale(1); opacity: 0.8; }
            100% { transform: translateY(-50px) scale(2); opacity: 0; }
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #1e293b; 
        }
        ::-webkit-scrollbar-thumb {
            background: #be185d; 
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- Confetti Effect Component ---
        const Confetti = ({ active }) => {
            const [particles, setParticles] = useState([]);

            useEffect(() => {
                if (active) {
                    const colors = ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#ff00ff', '#00ffff', '#ffffff'];
                    const newParticles = [];
                    for (let i = 0; i < 150; i++) {
                        newParticles.push({
                            id: i,
                            x: Math.random() * 100,
                            y: -10,
                            r: Math.random() * 10 + 5,
                            d: Math.random() * 10 + 10,
                            c: colors[Math.floor(Math.random() * colors.length)],
                            tilt: Math.floor(Math.random() * 10) - 10,
                            tiltAngle: 0,
                            tiltAngleIncr: (Math.random() * 0.07) + 0.05
                        });
                    }
                    setParticles(newParticles);
                }
            }, [active]);

            useEffect(() => {
                if (!active || particles.length === 0) return;
                
                const interval = setInterval(() => {
                    setParticles(prev => prev.map(p => ({
                        ...p,
                        y: p.y + (Math.random() * 3 + 1),
                        x: p.x + Math.sin(p.tiltAngle) * 2,
                        tiltAngle: p.tiltAngle + p.tiltAngleIncr
                    })).filter(p => p.y < 110));
                }, 20);

                return () => clearInterval(interval);
            }, [active, particles]);

            if (!active) return null;

            return (
                <div className="fixed inset-0 pointer-events-none z-50 overflow-hidden">
                    {particles.map(p => (
                        <div
                            key={p.id}
                            style={{
                                position: 'absolute',
                                left: `${p.x}%`,
                                top: `${p.y}%`,
                                width: `${p.r}px`,
                                height: `${p.r}px`,
                                backgroundColor: p.c,
                                transform: `rotate(${p.tilt}deg)`,
                                borderRadius: '50%'
                            }}
                        />
                    ))}
                </div>
            );
        };

        // --- Starry Background ---
        const StarField = () => {
            const stars = Array.from({ length: 50 }).map((_, i) => ({
                id: i,
                top: Math.random() * 100,
                left: Math.random() * 100,
                size: Math.random() * 3 + 1,
                duration: Math.random() * 3 + 2 + 's',
                opacity: Math.random()
            }));

            return (
                <div className="fixed inset-0 pointer-events-none z-0">
                    {stars.map(s => (
                        <div
                            key={s.id}
                            className="star"
                            style={{
                                top: `${s.top}%`,
                                left: `${s.left}%`,
                                width: `${s.size}px`,
                                height: `${s.size}px`,
                                '--duration': s.duration,
                                '--opacity': s.opacity
                            }}
                        />
                    ))}
                </div>
            );
        };

        // --- Main App ---
        const App = () => {
            const [step, setStep] = useState(0); // 0: Intro, 1: Main
            const [candlesBlown, setCandlesBlown] = useState(false);
            const [showConfetti, setShowConfetti] = useState(false);
            const [timeTogether, setTimeTogether] = useState({ days: 0, hours: 0, minutes: 0, seconds: 0 });
            
            // Music State
            const [isPlaying, setIsPlaying] = useState(false);
            const audioRef = useRef(null);

            // CONFIG: Met: 2014-10-02
            const startDate = new Date("2014-10-02T00:00:00"); 

            useEffect(() => {
                const timer = setInterval(() => {
                    const now = new Date();
                    const diff = now - startDate;
                    
                    const days = Math.floor(diff / (1000 * 60 * 60 * 24));
                    const hours = Math.floor((diff / (1000 * 60 * 60)) % 24);
                    const minutes = Math.floor((diff / 1000 / 60) % 60);
                    const seconds = Math.floor((diff / 1000) % 60);
                    
                    setTimeTogether({ days, hours, minutes, seconds });
                }, 1000);
                return () => clearInterval(timer);
            }, []);

            const handleEnter = () => {
                setStep(1);
                // Attempt to play music on user interaction
                if (audioRef.current) {
                    audioRef.current.play().then(() => {
                        setIsPlaying(true);
                    }).catch(e => console.log("Audio play failed:", e));
                }
            };

            const toggleMusic = () => {
                if (audioRef.current) {
                    if (isPlaying) {
                        audioRef.current.pause();
                    } else {
                        audioRef.current.play();
                    }
                    setIsPlaying(!isPlaying);
                }
            };

            const handleBlowCandles = () => {
                setCandlesBlown(true);
                setShowConfetti(true);
                setTimeout(() => setShowConfetti(false), 8000);
            };

            const loveNotes = [
                "2014å¹´çš„ç§‹å¤©é‡è§ä½ ï¼Œæ˜¯æˆ‘è¿™è¾ˆå­æœ€å¹¸è¿çš„äº‹ã€‚",
                "ä»äºŒäººä¸–ç•Œåˆ°ä¸‰å£ä¹‹å®¶ï¼Œè°¢è°¢ä½ ç»™äº†æˆ‘ä¸€ä¸ªå®Œç¾çš„å®¶ã€‚",
                "ä¸ç®¡æœªæ¥å¦‚ä½•ï¼Œæˆ‘éƒ½æƒ³ç‰µç€ä½ çš„æ‰‹ä¸€ç›´èµ°ä¸‹å»ã€‚",
                "ä½ å’Œå¥³å„¿çš„ç¬‘å®¹ï¼Œæ˜¯æˆ‘æ¯å¤©å¥‹æ–—çš„æœ€å¤§åŠ¨åŠ›ã€‚",
                "è€å©†ï¼Œç”Ÿæ—¥å¿«ä¹ï¼æ„¿æˆ‘ä»¬çš„ç”Ÿæ´»æ°¸è¿œå……æ»¡çˆ±ä¸æ¬¢ç¬‘ã€‚"
            ];

            const [currentNote, setCurrentNote] = useState(0);

            return (
                <div className="min-h-screen bg-slate-900 text-white overflow-hidden font-sans">
                    {/* Audio Element */}
                    <audio 
                        ref={audioRef} 
                        loop 
                        src="https://m701.music.126.net/20251229213602/ba5c29ce63430e338ad195853a49ecf0/jdymusic/obj/wo3DlMOGwrbDjj7DisKw/44041937333/292d/757b/9403/54fb039ce1eee13926c4e2cd35ab65d7.mp3?vuutv=FkIA/MRzFitS4ChE17gGrW8+UqFfNf1Qp+MNtP7FQPButQVn2s8tyI8pP29/8578vr5txeLEo+6b0MSsN91vjc8pD6OC6BUiJR3Mdlmu27FQXd5PAh6bPAdtDgSaCVbMAEJ3pzTha9aY9wi3NlSdjQ==&cdntag=bWFyaz1vc193ZWIscXVhbGl0eV9zdGFuZGFyZA"
                    />

                    {/* Music Control Button (Visible in Step 1) */}
                    {step === 1 && (
                        <button 
                            onClick={toggleMusic}
                            className="fixed top-4 right-4 z-50 p-3 bg-white/10 backdrop-blur rounded-full border border-white/20 hover:bg-white/20 transition-all group"
                        >
                            <div className={`relative ${isPlaying ? 'animate-spin-slow' : ''}`}>
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="text-pink-400">
                                    <path d="M9 18V5l12-2v13"/><circle cx="6" cy="18" r="3"/><circle cx="18" cy="16" r="3"/>
                                </svg>
                            </div>
                            {!isPlaying && (
                                <div className="absolute inset-0 flex items-center justify-center">
                                    <div className="w-full h-0.5 bg-white/70 rotate-45"></div>
                                </div>
                            )}
                        </button>
                    )}

                    {/* Intro Screen */}
                    {step === 0 && (
                        <div className="min-h-screen flex flex-col items-center justify-center relative">
                            <StarField />
                            <div className="z-10 text-center cursor-pointer transform hover:scale-105 transition-transform" onClick={handleEnter}>
                                <div className="text-pink-500 animate-heartbeat text-9xl mb-8 drop-shadow-[0_0_15px_rgba(236,72,153,0.8)]">
                                    â¤
                                </div>
                                <p className="text-xl md:text-2xl handwriting opacity-80 animate-pulse">
                                    ç‚¹å‡»çˆ±å¿ƒï¼Œå¼€å¯ä¸“å±ä½ çš„å®‡å®™
                                </p>
                                <p className="text-sm text-slate-500 mt-4">(èƒŒæ™¯éŸ³ä¹å°†éšä¹‹æ’­æ”¾)</p>
                            </div>
                        </div>
                    )}

                    {/* Main Content */}
                    {step === 1 && (
                        <div className="h-screen w-full overflow-y-auto overflow-x-hidden bg-gradient-to-b from-slate-900 via-purple-900 to-slate-900 relative">
                            <StarField />
                            <Confetti active={showConfetti} />

                            {/* Header */}
                            <header className="relative z-10 pt-20 pb-10 text-center px-4">
                                <h1 className="text-5xl md:text-7xl handwriting text-pink-300 mb-4 animate-float drop-shadow-lg">
                                    äº²çˆ±çš„è€å©†ï¼Œç”Ÿæ—¥å¿«ä¹
                                </h1>
                                <p className="text-slate-300 text-lg md:text-xl font-light">
                                    To the love of my life & the mother of our angel
                                </p>
                            </header>

                            {/* Time Together */}
                            <section className="relative z-10 max-w-4xl mx-auto my-12 p-6 bg-white/5 backdrop-blur-sm rounded-2xl border border-white/10 text-center mx-4 md:mx-auto">
                                <h2 className="text-2xl md:text-3xl mb-8 text-pink-200 handwriting">æˆ‘ä»¬ç›¸è¯†ç›¸çŸ¥çš„æ—¶é—´</h2>
                                <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                                    {[
                                        { label: "å¤©", val: timeTogether.days },
                                        { label: "å°æ—¶", val: timeTogether.hours },
                                        { label: "åˆ†é’Ÿ", val: timeTogether.minutes },
                                        { label: "ç§’", val: timeTogether.seconds }
                                    ].map((item, idx) => (
                                        <div key={idx} className="bg-white/10 p-4 rounded-xl">
                                            <div className="text-3xl md:text-5xl font-bold text-pink-400 font-mono">
                                                {item.val}
                                            </div>
                                            <div className="text-sm text-slate-400 mt-2">{item.label}</div>
                                        </div>
                                    ))}
                                </div>
                            </section>

                            {/* Milestones Timeline */}
                            <section className="relative z-10 max-w-6xl mx-auto my-12 px-6">
                                <h2 className="text-2xl md:text-3xl mb-8 text-pink-200 handwriting text-center">æˆ‘ä»¬çš„å¹¸ç¦è¶³è¿¹</h2>
                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                                    {[
                                        { date: "2014.10.02", title: "åˆæ¬¡ç›¸é‡", icon: "ğŸ’˜", desc: "æ•…äº‹çš„å¼€å§‹" },
                                        { date: "2015.09.09", title: "æ‰§å­ä¹‹æ‰‹", icon: "ğŸ’", desc: "é¢†è¯çºªå¿µæ—¥" },
                                        { date: "2016.10.05", title: "æµªæ¼«å©šç¤¼", icon: "ğŸ’’", desc: "è®¸ä¸‹ç»ˆèº«èª“è¨€" },
                                        { date: "2020.01.28", title: "å¤©ä½¿é™ä¸´", icon: "ğŸ‘¶", desc: "å¯çˆ±çš„å¥³å„¿å‡ºç”Ÿ" }
                                    ].map((m, i) => (
                                        <div key={i} className="bg-white/10 backdrop-blur-sm p-6 rounded-xl border border-white/5 text-center hover:bg-white/20 transition-all hover:-translate-y-2 duration-300 group">
                                            <div className="text-4xl mb-3 transform group-hover:scale-110 transition-transform">{m.icon}</div>
                                            <h3 className="text-xl font-bold text-pink-300 mb-1">{m.title}</h3>
                                            <div className="text-slate-300 font-mono text-sm mb-2">{m.date}</div>
                                            <p className="text-slate-400 text-sm handwriting">{m.desc}</p>
                                        </div>
                                    ))}
                                </div>
                            </section>

                            {/* Interactive Cake */}
                            <section className="relative z-10 my-20 text-center">
                                <h2 className="text-2xl md:text-3xl mb-8 text-pink-200 handwriting">
                                    {candlesBlown ? "æ„¿æœ›ä¸€å®šä¼šå®ç°ï¼" : "ç‚¹æ­¤å¹ç­èœ¡çƒ›è®¸æ„¿"}
                                </h2>
                                
                                <div 
                                    className="relative inline-block cursor-pointer transition-transform hover:scale-105"
                                    onClick={handleBlowCandles}
                                >
                                    {/* Cake SVG */}
                                    <svg width="300" height="300" viewBox="0 0 200 200">
                                        <ellipse cx="100" cy="170" rx="80" ry="20" fill="#e2e8f0" />
                                        <path d="M40,120 Q40,140 100,140 Q160,140 160,120 L160,90 Q160,110 100,110 Q40,110 40,90 Z" fill="#fbcfe8" />
                                        <path d="M40,90 Q40,110 100,110 Q160,110 160,90 L160,60 Q160,80 100,80 Q40,80 40,60 Z" fill="#f472b6" />
                                        <path d="M40,60 Q55,75 70,60 Q85,75 100,60 Q115,75 130,60 Q145,75 160,60 L160,120 Q160,140 100,140 Q40,140 40,120 Z" fill="#ec4899" />
                                        <rect x="95" y="30" width="10" height="35" fill="#fde047" rx="2" />
                                        <rect x="95" y="35" width="10" height="5" fill="#ef4444" opacity="0.5" />
                                        {!candlesBlown && (
                                            <g className="flame">
                                                <path d="M100,30 Q105,30 105,20 Q100,5 95,20 Q95,30 100,30" fill="#fbbf24" />
                                                <path d="M100,28 Q103,28 103,22 Q100,10 97,22 Q97,28 100,28" fill="#f59e0b" />
                                            </g>
                                        )}
                                        {candlesBlown && (
                                            <g className="smoke">
                                                <path d="M100,25 Q110,15 100,5" stroke="#cbd5e1" strokeWidth="2" fill="none" />
                                                <path d="M98,25 Q88,15 98,5" stroke="#cbd5e1" strokeWidth="2" fill="none" />
                                            </g>
                                        )}
                                    </svg>
                                </div>
                            </section>

                            {/* Love Notes Carousel */}
                            <section className="relative z-10 max-w-2xl mx-auto my-12 px-6 pb-20">
                                <div className="bg-white/90 backdrop-blur text-slate-800 p-8 rounded-lg shadow-2xl transform rotate-1 transition-all hover:rotate-0 min-h-[200px] flex flex-col justify-center items-center text-center relative">
                                    <div className="absolute -top-4 left-1/2 -translate-x-1/2 w-4 h-4 rounded-full bg-red-500 shadow-md"></div>
                                    <h3 className="text-xl font-bold mb-4 text-pink-600">ç»™æœ€çˆ±çš„ä½ </h3>
                                    <p className="text-xl md:text-2xl handwriting leading-loose">
                                        "{loveNotes[currentNote]}"
                                    </p>
                                    <div className="flex gap-4 mt-8">
                                        <button 
                                            onClick={() => setCurrentNote(prev => (prev === 0 ? loveNotes.length - 1 : prev - 1))}
                                            className="p-2 rounded-full hover:bg-pink-100 transition-colors"
                                        >
                                            â†
                                        </button>
                                        <button 
                                            onClick={() => setCurrentNote(prev => (prev === loveNotes.length - 1 ? 0 : prev + 1))}
                                            className="p-2 rounded-full hover:bg-pink-100 transition-colors"
                                        >
                                            â†’
                                        </button>
                                    </div>
                                </div>
                            </section>
                        </div>
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
